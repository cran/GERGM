#' @title A Function generate a scatter plot of observed vs predicted edge values.
#' @description Scatter plot of observed vs. predicted edge values generated by the
#' `conditional_edge_prediction()` function. Also calculated correlation coefficient.
#'
#' @param edge_prediction_results A list object returned by the
#' `conditional_edge_prediction()` function.
#' @param xlim Defaults to NULL, but can be set by the user if desired to a
#' numeric vector of the form c(lower,upper) for observed edge values.
#' @param ylim Defaults to NULL, but can be set by the user if desired to a
#' numeric vector of the form c(lower,upper) for predicted edge values.
#' @return Saves a PDF plot to the current working directory
#' @export
conditional_edge_prediction_correlation_plot <- function(
  edge_prediction_results,
  xlim = NULL,
  ylim = NULL) {

  # make diagnoal NA's
  diag(edge_prediction_results$predicted_edge_values) <- NA
  diag(edge_prediction_results$observed_network) <- NA

  # turn into a vector
  predicted_vals <- c(edge_prediction_results$predicted_edge_values)
  observed_vals <- c(edge_prediction_results$observed_network)

  # calculate correlation coefficient
  corcoef <- cor(predicted_vals, observed_vals, use = "complete.obs")

  # deal with NULL x and y limits
  if (is.null(xlim)) {
    xlim <- c(min(observed_vals, na.rm = TRUE),
              max(observed_vals, na.rm = TRUE))
  }
  if (is.null(ylim)) {
    ylim <- c(min(predicted_vals, na.rm = TRUE),
              max(predicted_vals, na.rm = TRUE))
  }

  UMASS_BLUE <- rgb(51,51,153,155,maxColorValue = 255)
  UMASS_RED <- rgb(153,0,51,255,maxColorValue = 255)

  plot(y = predicted_vals,
       x = observed_vals,
       pch = 19,
       col = UMASS_BLUE,
       xlab = "Observed Edge Value",
       ylab = "Predicted Edge Value",
       xlim = xlim, ylim = ylim,
       main = paste("Correlation Coefficient:",round(corcoef,4)))
  abline(a = 0, b = 1, lwd = 2, col = UMASS_RED)

}

